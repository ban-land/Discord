<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Content Loader</title>
</head>
<body>
  <div id="mainWrapper">
    <div id="upperTrigger" class="triggerElement"></div>
    <!-- Dynamic Content -->
    <div id="lowerTrigger" class="triggerElement"></div>
  </div>
<script>
  function fetchStyles() {
    const styleSource = `https://raw.githubusercontent.com/ban-land/Backups/refs/heads/main/Channels/ban%20land%20-%20ðŸ’¬%20chat%20-%20trash%20[703855942055493652]/[703855942055493652]_part_0.html`;

    fetch(styleSource)
      .then(res => res.text())
      .then(pageContent => {
        const domParser = new DOMParser();
        const parsedDoc = domParser.parseFromString(pageContent, 'text/html');
        const styleElements = parsedDoc.querySelectorAll('style, link[rel="stylesheet"]');

        styleElements.forEach(el => {
          document.head.appendChild(el.cloneNode(true));
        });
      })
      .catch(error => console.error('Error loading styles:', error));
  }

  document.addEventListener("DOMContentLoaded", fetchStyles);
</script>

  <script>
    let lowestPage = 0, highestPage = 0;
    let cachedPages = {};
    const mainWrapper = document.getElementById('mainWrapper');
    const upperTrigger = document.getElementById('upperTrigger');
    const lowerTrigger = document.getElementById('lowerTrigger');

function retrievePage(pageNum, insertAtTop = false) {
    if (pageNum < 0 || cachedPages[pageNum]) return;

    const newPageDiv = document.createElement("div");
    newPageDiv.className = "contentBlock placeholder";
    newPageDiv.id = `content_${pageNum}`;

    if (insertAtTop) {
        mainWrapper.insertBefore(newPageDiv, upperTrigger.nextSibling);
    } else {
        mainWrapper.insertBefore(newPageDiv, lowerTrigger);
    }

    let prevHeight = mainWrapper.scrollHeight;

    const contentUrl = `https://raw.githubusercontent.com/ban-land/Backups/refs/heads/main/Channels/ban%20land%20-%20ðŸ’¬%20chat%20-%20trash%20[703855942055493652]/[703855942055493652]_part_${pageNum}.html`;

    fetch(contentUrl)
        .then((res) => res.text())
        .then((pageData) => {
            const modifiedContent = modifyPageContent(pageData);
            newPageDiv.innerHTML = modifiedContent;
            newPageDiv.classList.remove("placeholder");
            cachedPages[pageNum] = newPageDiv;

            if (insertAtTop) {
                let newHeight = mainWrapper.scrollHeight;
                let heightDiff = newHeight - prevHeight;
                window.scrollBy(0, heightDiff);
            }
        })
        .catch((error) => console.error("Error fetching page", pageNum, error));
}
function modifyPageContent(pageData) {
    pageData = pageData.replace(
        /https:\/\/twemoji\.maxcdn\.com\/2\//g,
        "https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/"
    );

    let tempWrapper = document.createElement("div");
    tempWrapper.innerHTML = pageData;

    tempWrapper.querySelectorAll(".preamble__guild-icon-container").forEach(el => el.remove());

    tempWrapper.querySelectorAll(".preamble__entry").forEach(el => {
        if (el.textContent.trim() === "ban land") {
            el.remove();
        }
    });

    tempWrapper.querySelectorAll(".postamble").forEach(el => {
        el.innerHTML = '<a href="https://github.com/George-TheGamer">Content Restored by GeorgeTheGamer</a>';
    });

    return tempWrapper.innerHTML;
}

    const observeLower = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          let nextContent = highestPage + 1;
          retrievePage(nextContent, false);
          highestPage = nextContent;
        }
      });
    }, { rootMargin: '200px' });
    observeLower.observe(lowerTrigger);

    const observeUpper = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting && lowestPage > 0) {
          let previousContent = lowestPage - 1;
          retrievePage(previousContent, true);
          lowestPage = previousContent;
        }
      });
    }, { rootMargin: '200px' });
    observeUpper.observe(upperTrigger);

    retrievePage(0, false);
  </script>
</body>
</html>
