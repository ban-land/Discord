<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Page Loader</title>

</head>
<body>
  <div id="container">
    <div id="top-sentinel" class="sentinel"></div>
    <!-- Pages will be inserted here -->
    <div id="bottom-sentinel" class="sentinel"></div>
  </div>

 <script>
         function loadCSS() {
           const cssUrl = `https://raw.githubusercontent.com/ban-land/Backups/refs/heads/main/Channels/ban%20land%20-%20ðŸ’¬%20chat%20-%20trash%20[703855942055493652]/[703855942055493652]_part_0.html`;
         
           fetch(cssUrl)
             .then(response => response.text())
             .then(html => {
               // Extract CSS from the fetched HTML
               const parser = new DOMParser();
               const doc = parser.parseFromString(html, 'text/html');
               const styleTags = doc.querySelectorAll('style, link[rel="stylesheet"]');
         
               styleTags.forEach(tag => {
                 document.head.appendChild(tag.cloneNode(true));
               });
             })
             .catch(err => console.error('Error loading CSS from part_0:', err));
         }
         
         // Load CSS when the page is ready
         document.addEventListener("DOMContentLoaded", loadCSS);
         
           // Track the lowest and highest page numbers that have been loaded.
           let minPage = 0, maxPage = 0; // Starting page is 7.
           let pages = {}; // Cache loaded pages.
           const container = document.getElementById('container');
           const topSentinel = document.getElementById('top-sentinel');
           const bottomSentinel = document.getElementById('bottom-sentinel');
         
           // Loads a page. If 'prepend' is true, the page is inserted after the top sentinel.
         function loadPage(page, prepend = false) {
           if (page < 0 || pages[page]) return;
         
           const pageDiv = document.createElement("div");
           pageDiv.className = "page skeleton";
           pageDiv.id = `page_${page}`;
         
           if (prepend) {
               container.insertBefore(pageDiv, topSentinel.nextSibling);
           } else {
               container.insertBefore(pageDiv, bottomSentinel);
           }
         
           let prevHeight = container.scrollHeight;
         
           const url = `https://raw.githubusercontent.com/ban-land/Backups/refs/heads/main/Channels/ban%20land%20-%20ðŸ’¬%20chat%20-%20trash%20[703855942055493652]/[703855942055493652]_part_${page}.html`;
         
           // Use loadChannel instead of direct fetch processing
           fetch(url)
               .then((response) => response.text())
               .then((htmlContent) => {
                   const processedHTML = processChannelHTML(htmlContent);
                   pageDiv.innerHTML = processedHTML;
                   pageDiv.classList.remove("skeleton");
                   pages[page] = pageDiv;
         
                   if (prepend) {
                       let newHeight = container.scrollHeight;
                       let heightDiff = newHeight - prevHeight;
                       window.scrollBy(0, heightDiff);
                   }
               })
               .catch((err) => console.error("Error loading page", page, err));
         }
         function processChannelHTML(htmlContent) {
           htmlContent = htmlContent.replace(
               /https:\/\/twemoji\.maxcdn\.com\/2\//g,
               "https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/"
           );
         
           let tempContainer = document.createElement("div");
           tempContainer.innerHTML = htmlContent;
         
           tempContainer.querySelectorAll(".preamble__guild-icon-container").forEach(el => el.remove());
         
           tempContainer.querySelectorAll(".preamble__entry").forEach(el => {
               if (el.textContent.trim() === "ban land") {
                   el.remove();
               }
           });
         
           tempContainer.querySelectorAll(".postamble").forEach(el => {
               el.innerHTML = '<a href="https://github.com/George-TheGamer">Content Restored by GeorgeTheGamer</a>';
           });
         
           return tempContainer.innerHTML; // Return the modified HTML
         }
         
         
const createObserver = (sentinel, loadPageFunc, getPage) => {
  const observer = new IntersectionObserver(entries => {
    // Trigger loadPage when the sentinel is intersecting
    if (entries.some(entry => entry.isIntersecting)) {
      loadPageFunc(getPage());
    }
  });
  
  observer.observe(sentinel);
};

const incrementMaxPage = () => ++maxPage;
const decrementMinPage = () => (minPage > 0 ? --minPage : minPage);

createObserver(bottomSentinel, (page) => loadPage(page, false), incrementMaxPage);
createObserver(topSentinel, (page) => loadPage(page, true), decrementMinPage);

         
      </script>

</body>
</html>
